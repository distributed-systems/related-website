
	
	var   Class 		= require('ee-class')
		, log 			= require('ee-log')
		, assert 		= require('assert');



	var ResourceClient = require('../')
		, instance



	describe('The ResourceClient', function() {
		it('should not crash when instantiated', function(done) {
			instance = new ResourceClient();

			instance.load(['test.'], done);

			instance.on('request', function(request, response) {
				response.send(1, [
					{
						  id: 1
						, updated: '2014-05-30'
						, key: 'test.hui'
						, resourceLocale: [
							{
								  value: 'Hello *World*!'
								, language: {
									code: 'en'
								}
							}
							, {
								  value: '%first% Hello *World*! %middle%, %last%'
								, language: {
									code: 'de'
								}
							}
						]
					}
					, {
						  id: 1
						, updated: '2014-05-30'
						, key: 'test.hui.md'
						, resourceLocale: [
							{
								  value: 'Hello *World*!'
								, language: {
									code: 'en'
								}
							}
						]
					}
				]);
			});


		});		


		it('should return locales', function() {
			assert.equal(instance.get('test.hui', 'en'), 'Hello *World*!');
		});

		it('should compile variables into locales', function() {
			assert.equal(instance.get('test.hui', 'de', {first: '1', middle: '2', last: '3'}), '1 Hello *World*! 2, 3');
		});

		it('should transform markdown', function() {
			assert.equal(instance.get('test.hui.md', 'en'), '<p>Hello <em>World</em>!</p>\n');
		});

		it('should return an empty string when nothing was found', function() {
			assert.equal(instance.get('teasd', 'en'), '');
		});
	});
	